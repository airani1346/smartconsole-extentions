if [[ `$CPDIR/bin/cpprod_util FwIsFirewallModule 2>/dev/null` != *'1'* ]]; then echo; echo ' Not a firewall gateway! '; echo; else fw tab -t vpn_routing -u | awk 'NR>3 {$0=substr($0,2,28); gsub(", ", ""); gsub("; ", ""); gsub("..", "0x& "); print}' | xargs printf "%d.%d.%d.%d %d.%d.%d.%d %d.%d.%d.%d\n" | awk '{print $3"."$1" - "$2}' | sort -t . -k  1,1n -k 2,2n -k 3,3n -k 4,4n -k 5,5n -k 6,6n -k 7,7n -k 8,8n | sed 's/^/x/' | sed 's/\./\n\t/4' | awk '!x[$0]++' | sed '/x/s/$/\n\tEncryption domain/' | sed 's/x/\nVPN Gateway > /'; echo; fi; if [[ `grep R80.40 /etc/cp-release | wc -l` != 0 ]]; then echo -n 'Info: VPN Domain for Gateway Communities are currently not displayed correctly by this tool! '; echo; echo; fi
